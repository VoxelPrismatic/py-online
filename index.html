<!DOCTYPE html>
<html>
    <head>
        <!-- EMBED STUFF -->
        <meta property="og:title" content="PYTHON INTERPRETER ;]"/>
        <meta property="og:description" content="An online Python console"/>
        <!-- OTHER THINGS -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <meta charset="utf-8"/>
        <meta name="description" content="An online Python console"/>
        <!-- FONTS -->
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu+Mono"/>   
        <!-- SCRIPTS -->
        <script src="https://cdn.jsdelivr.net/gh/brython-dev/brython/www/src/brython.js" id="brython_load"></script>
        <script src="https://cdn.jsdelivr.net/gh/brython-dev/brython/www/src/brython_stdlib.js" id="brython_mods"></script>
        <script type="text/javascript" src="loader/console.js" id="fns_js" async></script>
        <title>PYTHON ;]</title>
        <style>
            .bg {
                background-color: #112222;
                color: #00ffff;
                font-family: "Ubuntu Mono";
            } .console {
                width: 90vw;
                height: 90vh;
                left: 0;
                right: 0;
                top: 0;
                bottom: 0;
                margin: auto;
                max-height: 90vh;
                overflow-y: auto;
                overflow-wrap: break-word;
            } .err {
                color: #ff0000;
            } .con {
                color: #00ff00;
            } .rtn {
                color: #ff0088;
            }
        </style>
    </head>
    <body class="bg" onload="brython()">
        <div class="console" onclick="this.contentEditable='true';" id="c">
        </div>
        <script type="text/python">
            from browser import document as doc, html, window as win
            global c
            c = doc["c"]
            c.innerHTML += f"Brython Console - Emulating Python v{win.__BRYTHON__.__MAGIC__}<br>"
            global stdin, thing
            thing = ">>> "
            stdin = ""
            def serial(st):
                st = st.replace("&", "&amp;")
                st = st.replace("<", "&lt;")
                st = st.replace(">", "&gt;")
                st = st.replace(" ", "\u200b \u200b")
                st = st.replace("\n", "<br>")
                return st
            def print(*args, end = "\n", sep = " "):
                st = sep.join(args)+end
                st = serial(st)
                doc["c"] += st
            def null_print(*args, **kwargs):
                pass
            def interpret():
                global stdin, thing
                c = doc["c"]
                if stdin:
                    stdin += "\n"+c.innerHTML.split("<br>")[-1].split("</span>", 1)[1].replace("\u200b \u200b", " ")
                else:
                    stdin = c.innerHTML.split("<br>")[-1].split("</span>", 1)[1].replace("\u200b \u200b", " ")
                c.innerHTML += "<br>"
                if stdin.endswith(":"):
                    if thing == ">>> ":
                        thing = "... "
                    thing += "    "
                    c.innerHTML += "<span class='con'>"+thing[:4]+"</span>"+thing[4:].replace(" ", "\u200b \u200b")
                    return
                if stdin.endswith("\n"):
                    try:
                        exec(stdin)
                        try:
                            out = eval(stdin, {"print": null_print})
                        except:
                            out = None
                        typ = str(type(out)).split("'")[1]
                        c.innerHTML += "<span class='rtn'>"+serial(typ)+"</span><br>"
                    except Exception as ex:
                        c.innerHTML += "<span class='err'>"+serial(str(ex))+"</span><br>"
                    thing = ">>> "
                    c.innerHTML += "<span class='con'>"+serial(thing)+"</span>"
                    stdin = ""
            def keys(k):
                if k.code == "Enter":
                    interpret()
            c.bind("keydown", keys)
            c.innerHTML += "<span class='con'>"+serial(thing)+"</span>"
        </script>
    </body>
</html>
